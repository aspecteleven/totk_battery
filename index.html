<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shrine Lantern Controller</title>
    <link rel="stylesheet" href="styles.css">
    <!-- styles moved to styles.css; inline CSS removed to avoid duplication -->
</head>
<body>

    <!-- RESET BUTTON (Intro Only) -->
    <div id="resetUserBtn" title="Reset Name & Intro">X</div>

    <!-- DEMO MODE BUTTON (Main App Only) -->
    <div id="offlineBtn" title="Demo / Offline Mode"></div>

    <!-- INTRO SCREEN -->
    <div id="introScreen">
        <div class="intro-symbol"></div>
        <div class="intro-text-area">
            <div class="intro-prompt" id="introPrompt">Greetings. Please enter your name</div>
            <input type="text" id="nameInput" autocomplete="off" maxlength="15">
            <div class="intro-welcome" id="introWelcome"></div>
        </div>
        <button class="intro-btn" id="continueBtn">Continue</button>
    </div>

    <!-- MAIN APP WRAPPER -->
    <div id="mainApp">
        <div class="container">
            <div class="stone_overlay stone_overlay_left"></div><div class="stone_overlay stone_overlay_right"></div>
            <div class="stones stone_left"></div><div class="stones stone_right"></div>
            <div class="elements elements_top"></div><div class="elements elements_bottom"></div>
        </div>
        <div class="battery_container">
            <div class="battery_display">
                <div class="battery_body"></div><div class="battery_glass"></div>
                <div class="battery_glass_glow" id="glowLayer"></div>
                <div class="battery_glass_glow_overlay"></div>
            </div>
        </div>

        <div class="control-panel">
            <h1>LANTERN CONTROL</h1>
            <div class="dashboard-section sec-system">
                <button id="connToggle" class="btn-connect">Connect</button>
                <select id="modeSelect" disabled>
                    <option value="solid">Solid Color</option>
                    <option value="fade">Breathing Fade</option>
                    <option value="snake">Snake</option>
                </select>
                <select id="commsMode" title="Connection mode">
                    <option value="auto">Auto</option>
                    <option value="serial">Serial (USB)</option>
                    <option value="http">HTTP (WiFi)</option>
                </select>
            </div>

            <div class="dashboard-section sec-controls" id="controlsArea"></div>

            <div class="dashboard-section sec-actions">
                <button id="defaultBtn" disabled>Defaults</button>
                <button id="settingsBtn" title="Settings" style="padding:8px;border-radius:6px;font-size:12px;">Settings</button>
                <div class="status" id="statusText">Ready</div>
            </div>

            <!-- Settings overlay (WiFi, Device IP, Assets) -->
            <div id="settingsOverlay" class="hidden" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:600;padding:20px;">
                <div id="settingsModal" style="background:#08121a;padding:18px;border-radius:8px;border:1px solid #333;margin-top:-700px;min-width:320px;max-width:640px;position:relative;color:#ccc;">
                    <button id="settingsClose" title="Close" style="position:absolute;top:8px;right:8px;padding:6px;border-radius:6px;background:transparent;color:#ccc;border:none;cursor:pointer;">X</button>
                    <h3 style="margin:0 0 10px 0;color:var(--accent);">Settings</h3>

                    <div style="display:flex;flex-direction:column;gap:10px;">
                        <label style="font-size:12px;color:#aaa;">GitHub Pages URL
                            <input id="githubUrl" value="https://aspecteleven.github.io/totk_battery/" style="width:100%;margin-top:6px;padding:8px;border-radius:4px;border:1px solid #444;background:#07121a;color:#ccc;" />
                        </label>

                        <label style="font-size:12px;color:#aaa;">Asset Base
                            <div style="display:flex;gap:8px;margin-top:6px;">
                                <input id="assetBase" placeholder="Asset base (optional)" style="flex:1;padding:8px;border-radius:4px;border:1px solid #444;background:#07121a;color:#ccc;" />
                                <button id="applyAssetsBtn" style="padding:8px;border-radius:4px;">Apply</button>
                            </div>
                        </label>

                        <hr style="border:none;border-top:1px solid #222;margin:6px 0;" />

                        <div style="display:flex;align-items:center;gap:8px;">
                            <label style="font-size:12px;color:#aaa;min-width:80px;">Device IP</label>
                            <input id="deviceIp" placeholder="Device IP (optional)" style="flex:1;padding:8px;border-radius:4px;border:1px solid #444;background:#07121a;color:#ccc;" />
                            <button id="pingBtn" style="padding:8px;border-radius:4px;">Ping</button>
                        </div>

                        <hr style="border:none;border-top:1px solid #222;margin:6px 0;" />

                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div style="font-size:12px;color:#aaa;">WiFi Configuration</div>
                        </div>
                        <input id="wifi_ssid" placeholder="SSID" style="padding:8px;border-radius:4px;border:1px solid #444;background:#07121a;color:#ccc;" />
                        <input id="wifi_pass" placeholder="Password" type="password" style="padding:8px;border-radius:4px;border:1px solid #444;background:#07121a;color:#ccc;" />
                        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
                            <button id="wifiCancel" style="padding:8px;border-radius:4px;">Cancel</button>
                            <button id="wifiSubmit" style="padding:8px;border-radius:4px;">Connect</button>
                        </div>
                        
                        <div style="display:flex;align-items:center;gap:8px;margin-top:6px;">
                            <input type="checkbox" id="wifiDiagToggle" />
                            <label for="wifiDiagToggle" style="font-size:12px;color:#aaa;">Enable WiFi diagnostics (serial heartbeats)</label>
                        </div>
                        <hr style="border:none;border-top:1px solid #222;margin:8px 0;" />
                        <div style="font-size:12px;color:#aaa;">Serial Log</div>
                        <div style="display:flex;gap:8px;margin-top:6px;">
                            <pre id="serialLog" class="serial-log" style="flex:1;min-height:120px;overflow:auto;margin:0;padding:8px;border-radius:4px;border:1px solid #222;background:#061017;color:#ccc;font-family:monospace;font-size:12px;"></pre>
                        </div>
                        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
                            <button id="clearLog" style="padding:8px;border-radius:4px;">Clear</button>
                            <button id="fetchLogs" style="padding:8px;border-radius:4px;">Fetch Device Logs</button>
                            <button id="downloadLog" style="padding:8px;border-radius:4px;">Download</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
<div class="versions" id="versions">HTML v2.15 | JS v2.18 | CSS v2.3</div>

    <script src="main.js"></script>
</body>
</html>
